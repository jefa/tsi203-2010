<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich"
	xmlns:fn="http://java.sun.com/jsp/jstl/functions">
<ui:composition template="templates/usuarioUI.xhtml">
	<ui:define name="title">Mi Perfil</ui:define>
	<ui:define name="body">

		<rich:modalPanel id="panel" width="425" height="345">
			<f:facet name="header">
				<h:panelGroup>
					<h:outputText value="Subir imagen de perfil"></h:outputText>
				</h:panelGroup>
			</f:facet>
			<a4j:form id="modalUpload">
				<rich:fileUpload fileUploadListener="#{Profile.listener}"
					maxFilesQuantity="#{Profile.cantUploads}" id="upload"
					immediateUpload="true" acceptedTypes="jpg, gif, png, bmp">
				</rich:fileUpload>
				<br />
				<h:commandButton value="Confirmar"
					action="#{Profile.confirmAvatarChange}" />
				<h:panelGroup style="margin-left:5px">
					<h:commandButton value="Cancelar" id="hidelink" />
					<rich:componentControl for="panel" attachTo="hidelink"
						operation="hide" event="onclick" />
				</h:panelGroup>
			</a4j:form>
		</rich:modalPanel>

		<rich:modalPanel id="panelPassword" width="425" height="245">
			<f:facet name="header">
				<h:panelGroup>
					<h:outputText value="Cambiar password"></h:outputText>
				</h:panelGroup>
			</f:facet>
			<h:form>
				<rich:panel>
					<h:outputText value="Nueva contraseña:"></h:outputText>
					<br />
					<h:inputSecret value="#{Profile.newPassword}" size="50"></h:inputSecret>
					<br />
					<br />
					<h:outputText value="Confirmación de contraseña:"></h:outputText>
					<br />
					<h:inputSecret value="#{Profile.confirmNewPassword}" size="50"></h:inputSecret>
				</rich:panel>

				<br />
				<h:commandButton value="Confirmar"
					action="#{Profile.passModification}" />
				<h:panelGroup style="margin-left:5px">
					<h:commandButton value="Cancelar" id="hidelink" />
					<rich:componentControl for="panelPassword" attachTo="hidelink"
						operation="hide" event="onclick" />
				</h:panelGroup>
			</h:form>

		</rich:modalPanel>

		<rich:modalPanel id="panelDatos" width="425" height="245">
			<f:facet name="header">
				<h:panelGroup>
					<h:outputText value="Modificar datos"></h:outputText>
				</h:panelGroup>
			</f:facet>
			<h:form>
				<rich:panel>
					<h:outputText value="Nombre:"></h:outputText>
					<br />
					<h:inputText value="#{Profile.user.name}" size="50"></h:inputText>
					<br />
					<br />
					<h:outputText value="E-Mail"></h:outputText>
					<br />
					<h:inputText value="#{Profile.user.email}" size="50"></h:inputText>
				</rich:panel>

				<br />
				<h:commandButton value="Confirmar"
					action="#{Profile.userModification}" />
				<h:panelGroup style="margin-left:5px">
					<h:commandButton value="Cancelar" id="hidelink" />
					<rich:componentControl for="panelDatos" attachTo="hidelink"
						operation="hide" event="onclick" />
				</h:panelGroup>
			</h:form>

		</rich:modalPanel>



		<h:form id="privateProfile">
			<f:view>

				<div class="home-title">Mi Perfil</div>
				<ul class="hfeed posts-quick clearfix">
					<li class="post type-post clearfix">
					<div class="entry-thumbnails"><h:graphicImage
						value="/UserImageFeeder?username=#{Profile.userId}"
						styleClass="attachment-quick-preview-thumb wp-post-image" /></div>

					<div class="entry-summary">
					<table>
						<tr>
							<td width="125px"><strong>Usuario:</strong></td>
							<td width="625px"><h:outputText
								value="#{Profile.user.username}" /></td>
						</tr>
						<tr>
							<td><strong>Nombre:</strong></td>
							<td><h:outputText value="#{Profile.user.name}" /></td>
						</tr>
						<tr>
							<td><strong>Email:</strong></td>
							<td><h:outputText value="#{Profile.user.email}" /></td>
						</tr>

					</table>
					<p class="quick-read-more"
						style="margin-top: 0px; display: inline; margin-right: 10px;"><h:outputLink
						value="#" id="linkDatos" style="width:102px">
								        Modificar datos
								        <rich:componentControl for="panelDatos"
							attachTo="linkDatos" operation="show" event="onclick" />
					</h:outputLink></p>
					<p class="quick-read-more"
						style="margin-top: 5px; margin-right: 10px; display: inline"><h:outputLink
						value="#" id="link" rendered="#{!Profile.user.usuarioFacebook}"
						style="width:102px">
								        Cambiar imagen
								        <rich:componentControl for="panel" attachTo="link"
							operation="show" event="onclick" />
					</h:outputLink></p>




					<p class="quick-read-more"
						style="margin-top: 0px; display: inline; margin-right: 10px;"><h:outputLink
						value="#" id="linkPassword"
						rendered="#{!Profile.user.usuarioFacebook}"
						style="width:108px;padding-left:5px">
								        Cambiar password
								        <rich:componentControl for="panelPassword"
							attachTo="linkPassword" operation="show" event="onclick" />
					</h:outputLink></p>

					</div>

					</li>
				</ul>
			</f:view>
		</h:form>

				<div class="home-title">Eventos a los que pertenezco</div>
				<h:form id="eventosPertenezco">
					<a4j:repeat var="contenido" rowKeyVar="rk"
						value="#{Profile.eventosDelUsuario}" rows="10">

						<li class="clearfix"><span class="thumb"
							style="height: 36px; vertical-align: middle;"><h:graphicImage
							value="/ContentFeeder?id=#{contenido.coverId}&#38;thb=36"
							styleClass="attachment-sidebar-thumb wp-post-image" width="36px"
							height="36px"
							style="vertical-align:middle;margin-right:5px;padding-bottom:10px" /></span>
						<strong><h:commandLink value="#{contenido.evtName}"
							action="verEvento">
							<f:setPropertyActionListener value="#{contenido.evtId}"
								target="#{eventoMB.eventId}" />
						</h:commandLink> </strong>
					
						
						</li>
					</a4j:repeat>
					<h:outputText
						rendered="#{fn:length(Profile.eventosDelUsuario) == 0}"
						value="No pertenece a ningun evento" />
				</h:form>
	</ui:define>
</ui:composition>
</html>