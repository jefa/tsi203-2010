<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">

<ui:composition template="templates/superusuarioUI.xhtml">
	<ui:define name="title">Crear un Evento</ui:define>
	<ui:define name="body">
	<h:form id="CreateEvent">
		<f:view>
			<rich:panel>
				<f:facet name="header">
					<h:outputText value="Nuevo Evento"></h:outputText>
				</f:facet>
				<h:panelGrid columns="2">
					<h:panelGroup>
						<h:outputText value="Nombre del evento:"></h:outputText><br/>
						<h:inputText value="#{EventMB.name}"></h:inputText>
							<h:outputText value="#{EventMB.nameMessage}" style="color:red"></h:outputText><br/>
						
						<h:outputText value="Categoría:"/><br/>
						<h:selectOneMenu value="#{EventMB.category}">
							<f:selectItems value="#{EventMB.allCats}" />
						</h:selectOneMenu><br/><br/>	
							
						<h:outputText value="Descripción:"></h:outputText><br/>
						<h:inputText  value="#{EventMB.description}"></h:inputText>
							<h:outputText value="#{EventMB.descriptionMessage}" style="color:red"></h:outputText><br/>
						<h:outputText value="Fecha:"></h:outputText><br/>				
						<rich:calendar value="#{EventMB.date}"
		                    datePattern="d/MMM/y"  showApplyButton="false"  
		                    cellWidth="24px" cellHeight="22px" style="width:200px"/><br/>
						<h:outputText value="Duración:"></h:outputText><br/>
						<h:inputText value="#{EventMB.duration}"></h:inputText>
							<h:outputText value="#{EventMB.durationMessage}" style="color:red"></h:outputText><br/>
						<h:outputText value="Dirección:"></h:outputText><br/>
						<h:inputText id="address" value="#{EventMB.address}"></h:inputText>
							<h:outputText value="#{EventMB.addressMessage}" style="color:red"></h:outputText><br/>
						
						<input type="button" value="Buscar Dirección" onclick="showAddress('CreateEvent:address', map);"/><br/>
			        	<input type="button" value="Borrar Marcadores" onclick="eraseMarkers(map);"/><br/>
			        	
			            <h:inputHidden id="hidden_coord_lat" value="#{EventMB.latitude}" /><br/>
			            <h:inputHidden id="hidden_coord_lng" value="#{EventMB.longitude}"/><br/>
			            
			            <table border='1' id='markerTable'>
						<tbody>
						</tbody>
						</table>					
						
					 </h:panelGroup>
					<h:panelGroup>
			        	<rich:gmap  gmapVar="map" style="width:400px;height:400px" id="map" lat="-34.831" lng="-56.2055"  enableDoubleClickZoom="true"
			        zoom="11" mapType="G_NORMAL_MAP"/>
			        
			        <!--
			        	<h:outputText value="Calle: "/><br/><h:inputText id="street"/><br/>
			        	<h:outputText value="Ciudad: "/><br/><h:inputText id="city"/><br/>
			        	<h:outputText value="País: "/><br/><h:inputText id="country"/><br/>-->
			        	<!-- a href="javascript: void 0" onclick="addMarker(map, -34.831, -56.2055);">Colocar marcador bien</a><br/-->
			        	<!-- a href="javascript: void 0" onclick="showAddress2('CreateEvent:street', 'CreateEvent:city', 'CreateEvent:country', map);">Colocar marcador por dir</a><br/-->
			        	<!-- input type="button" value="Buscar Dirección" onclick="showAddress3('CreateEvent:street', 'CreateEvent:city', 'CreateEvent:country', map);"/><br/-->
			        	
			        </h:panelGroup>
				</h:panelGrid>
				
				<h:outputText value="Evento es moderado:"/>
						<h:selectBooleanCheckbox value="#{EventMB.moderated}" 
						onclick="toggleVisibility('divNewMod');"/><br/><br/>
						<div id="divNewMod">
						<h:inputText id="newMod" value="#{EventMB.suggest}" />
						<h:commandButton value="Agregar como moderador" action="#{EventMB.addMod}"/>
						<h:commandButton value="Limpiar lista" action="#{EventMB.resetMod}"/>
						<rich:suggestionbox id="suggestionBoxId" for="newMod" tokens=",["
							suggestionAction="#{EventMB.autocomplete}" var="result"
							nothingLabel="No user matches" columnClasses="center">
							<h:column>
								<h:outputText value="#{result.username}" />
							</h:column>
							<h:column>
								<h:outputText value="#{result.name}" />
							</h:column>
						</rich:suggestionbox>
						<rich:panel style="width:50%">
				            <f:facet name="header">
				                <h:outputText value="Moderadores"/>
				            </f:facet>
				            <rich:dataList value="#{EventMB.mods}" var="pickList" rendered="#{EventMB.cantMods>0}">
				            	<h:outputText value="#{pickList}"/>
				            </rich:dataList> 
				        </rich:panel>
				        <h:outputText value="#{EventMB.modsMessage}" style="color:red"></h:outputText><br/>
				        </div>
			   <!--Inicilizamos el geoCoder-->
			   <script>window.onload=function(){initGeoCoder(map);}</script>
			   
				<center>
				        
				<h:commandButton value="Crear el evento" action="#{EventMB.createEvent}">
					<f:setPropertyActionListener value="#{loginMB.userName}"
								target="#{EventMB.creator}" />
				</h:commandButton>
				<br/>
				</center>
			</rich:panel>
		</f:view>
	</h:form>
	</ui:define>
</ui:composition>
</html>