<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets" 
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">

<ui:composition template="templates/superusuarioUI.xhtml">
	<ui:define name="title">Crear un Evento</ui:define>
	<ui:define name="body">
	<script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=false"></script>
	<script type="text/javascript" src="scripts/googlemaps.js"></script> 
	<h:form id="CreateEvent">
		<f:view>
			<rich:panel>
				<f:facet name="header">
					<h:outputText value="Nuevo Evento"/>
				</f:facet>
				<center>
				<h:panelGrid columns="2">
					<h:panelGroup>
						<h:outputText value="Nombre del evento:"/><br/>
						<h:inputText value="#{EventMB.nameC}" size="60" style="margin-right:5px"/>
							<h:outputText value="#{EventMB.nameMessageC}" style="color:red"/><br/>
						<br/>
						<h:outputText value="Categoría:"/><br/>
						<h:selectOneMenu value="#{EventMB.categoryC}">
							<f:selectItems value="#{EventMB.allCats}" />
						</h:selectOneMenu><br/><br/>	
							
						<h:outputText value="Descripción:"/><br/>
						<h:inputTextarea  value="#{EventMB.descriptionC}" cols="45" rows="3"/>
							<h:outputText value="#{EventMB.descriptionMessageC}" style="color:red"/><br/>
						<br/>
						<h:outputText value="Fecha:"/><br/>				
						<rich:calendar value="#{EventMB.dateC}"
		                    datePattern="d/MMM/y"  showApplyButton="false"  
		                    cellWidth="24px" cellHeight="22px" style="width:200px"/><br/>
						<br/>
						<h:outputText value="Horario:"/><br/>
						<h:inputText value="#{EventMB.durationC}" size="60"/>
							<h:outputText value="#{EventMB.durationMessageC}" style="color:red"/><br/>
						<br/>
						<h:outputText value="Dirección:"/><br/>
						<h:inputText id="address" value="#{EventMB.addressC}" size="60"/>
							<h:outputText value="#{EventMB.addressMessageC}" style="color:red"/><br/>
						
						<input type="button" value="Buscar Dirección" onclick="showAddress('CreateEvent:address', map, 'CreateEvent:hidden_coord_lat', 'CreateEvent:hidden_coord_lng');"/>
			        	<input type="button" value="Borrar Marcadores" onclick="eraseMarkers(map, 'CreateEvent:hidden_coord_lat', 'CreateEvent:hidden_coord_lng');"/>
			        	
			            <h:inputHidden id="hidden_coord_lat" value="#{EventMB.latitudeC}" /><br/>
			            <h:inputHidden id="hidden_coord_lng" value="#{EventMB.longitudeC}"/><br/>
			            
			            <table border='1' id='markerTable'>
						<tbody>
						</tbody>
						</table>
							
						<br/>
						
			            <h:outputText value="Hashtag de Twitter:"/><br/>
						<h:inputText value="#{EventMB.hashtagC}" size="60"/>
						
			            
			            				
						
					 </h:panelGroup>
					<h:panelGroup>
			        	<rich:gmap  gmapVar="map" style="width:400px;height:400px" id="map" lat="-34.831" lng="-56.2055"  enableDoubleClickZoom="true"
			        zoom="11" mapType="G_NORMAL_MAP"/>
			        
			        <!--
			        	<h:outputText value="Calle: "/><br/><h:inputText id="street"/><br/>
			        	<h:outputText value="Ciudad: "/><br/><h:inputText id="city"/><br/>
			        	<h:outputText value="País: "/><br/><h:inputText id="country"/><br/>-->
			        	<!-- a href="javascript: void 0" onclick="addMarker(map, -34.831, -56.2055);">Colocar marcador bien</a><br/-->
			        	<!-- a href="javascript: void 0" onclick="showAddress2('CreateEvent:street', 'CreateEvent:city', 'CreateEvent:country', map);">Colocar marcador por dir</a><br/-->
			        	<!-- input type="button" value="Buscar Dirección" onclick="showAddress3('CreateEvent:street', 'CreateEvent:city', 'CreateEvent:country', map);"/><br/-->
			        	
			        </h:panelGroup>
				</h:panelGrid>
				</center>
				<br/>				
				
				<br/>
				<a4j:outputPanel id="participantsPanel">
				
					<rich:panel style="width:87%;margin-left:60px">
				
						<h:inputText id="newParticipant" value="#{EventMB.suggestParticipantsC}" size="60"/>
						<a4j:commandButton value="Agregar como participante" action="#{EventMB.addParticipantC}" reRender="participantsPanel"/>
						<a4j:commandButton value="Limpiar lista" action="#{EventMB.resetParticipantsC}" reRender="participantsPanel"/>
						<rich:suggestionbox id="suggestionBoxIdParticipant" for="newParticipant" tokens=",["
							suggestionAction="#{EventMB.autocompleteParticipantsC}" var="result"
							nothingLabel="No hay usuarios que coincidan" columnClasses="center">
							<h:column>
								<h:outputText value="#{result.username}" />
							</h:column>
							<h:column>
								<h:outputText value="#{result.name}" />
							</h:column>
						</rich:suggestionbox>
						
				            <f:facet name="header">
				                <h:outputText value="Participantes del evento"/>
				            </f:facet>
				            <br/><br/>
				            <h:outputText value="El evento no tiene ningún participante" style="font-style:italic" rendered="#{EventMB.cantParticipantsC eq 0}"/>
				            <rich:dataList value="#{EventMB.participantsC}" var="pickList" rendered="#{EventMB.cantParticipantsC>0}">
				            	<h:outputText value="#{pickList}"/>
				            </rich:dataList> 
				        </rich:panel>
				        <h:outputText value="#{EventMB.participantsMessageC}" style="color:red"/><br/>
				</a4j:outputPanel>
				
				<hr/>
				
				<a4j:outputPanel id="modPanel" style="margin-left:60px">
				<h:outputText value="Evento es moderado:"/>
					
						<h:selectBooleanCheckbox id="effCheck" value="#{EventMB.moderatedC}" 
						onclick="if(document.getElementById('CreateEvent:effCheck').checked) showDiv(); else hideDiv({duration:0.7});" />

					<div id="divNewMod">
					<rich:panel style="width:87%;margin-left:60px" id="richModPanel">
						
						<h:inputText id="newMod" value="#{EventMB.suggestModsC}"  size="60"/>
						<a4j:commandButton value="Agregar como moderador" action="#{EventMB.addModC}" reRender="modPanel"/>
						<a4j:commandButton value="Limpiar lista" action="#{EventMB.resetModC}" reRender="modPanel"/>
						<rich:suggestionbox id="suggestionBoxIdMod" for="newMod" tokens=",["
							suggestionAction="#{EventMB.autocompleteModsC}" var="result"
							nothingLabel="No hay usuarios que coincidan" columnClasses="center">
							<h:column>
								<h:outputText value="#{result.username}" />
							</h:column>
							<h:column>
								<h:outputText value="#{result.name}" />
							</h:column>
						</rich:suggestionbox>
						
				            <f:facet name="header">
				                <h:outputText value="Moderadores del evento"/>
				            </f:facet>
				            <br/><br/>
				            <h:outputText value="El evento no tiene ningún moderador" style="font-style:italic" rendered="#{EventMB.cantModsC eq 0}"/>
				            <rich:dataList value="#{EventMB.modsC}" var="pickList" rendered="#{EventMB.cantModsC>0}">
				            	<h:outputText value="#{pickList}"/>
				            </rich:dataList> 
				        </rich:panel>
				        <h:outputText value="#{EventMB.modsMessageC}" style="color:red"/><br/>
				        </div>
				</a4j:outputPanel>	 
				
			   <!--Inicilizamos el geoCoder-->
			   <script>window.onload=function(){initGeoCoder(map, 'CreateEvent:hidden_coord_lat', 'CreateEvent:hidden_coord_lng');}</script>
			   
			   
				
				<rich:effect  name="hideDiv"  for="richModPanel" type="BlindUp" />
				<rich:effect  name="showDiv"  for="richModPanel" type="BlindDown" />
				

				<center>
				<br/>
				<br/>	        
				<h:commandButton value="Crear el evento" action="#{EventMB.createEvent}">
					<f:setPropertyActionListener value="#{loginMB.userName}"
								target="#{EventMB.creatorC}" />
				</h:commandButton>
				
				</center>
			</rich:panel>
		</f:view>
	</h:form>
	</ui:define>
</ui:composition>
</html>