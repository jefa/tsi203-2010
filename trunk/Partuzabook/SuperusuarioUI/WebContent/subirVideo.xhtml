<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:a4j="http://richfaces.org/a4j"
	xmlns:rich="http://richfaces.org/rich">
<body>
<ui:composition template="templates/superusuarioUI.xhtml">
	<ui:define name="title">Subir video</ui:define>
	<ui:define name="body">
	
		<rich:modalPanel id="panelNewCat" height="140">
			<f:facet name="header">
		    	<h:panelGroup>
		        	<h:outputText value="Crear una categoria"></h:outputText>
		    	</h:panelGroup>
			</f:facet>
			<a4j:form>
				<h:outputText value="Nombre de la nueva categoria:"/><br/>
				<h:inputText value="#{subirVideoMB.newCatAux}" size="41" maxlength="100"/><br/><br/>
				<p align="right">
					<h:panelGroup>
						<a4j:commandButton reRender="info" value="Confirmar" id="confirmarNewcat" action="#{subirVideoMB.addCategory}" 
						oncomplete="if('#{subirVideoMB.newCatAuxMessage}' != '') alert('#{subirVideoMB.newCatAuxMessage}'); else #{rich:component('panelNewCat')}.hide();"/>
					</h:panelGroup>						
					<h:panelGroup>
						<a4j:commandButton value="Cancelar" id="cancelarNewCat" />
						<rich:componentControl for="panelNewCat" attachTo="cancelarNewCat" operation="hide" event="onclick"/>
					</h:panelGroup>
				</p>
			</a4j:form>
		</rich:modalPanel>
		
		<rich:modalPanel id="panel" rendered="#{subirVideoMB.videoUploaded eq false}" width="500" height="130">
			<f:facet name="header">
		    	<h:panelGroup>
		        	<h:outputText value="Seleccionar video"></h:outputText>
		    	</h:panelGroup>
			</f:facet>
				<form action="#{subirVideoMB.post_url}" method ="post" enctype="multipart/form-data">
					<input type="file" name="file" size="45"/>
					<input type="hidden" name="token" value="#{subirVideoMB.token_id}"/>
					<input type="submit" value="Confirmar" />
				</form>
				<br/>
				<a4j:form id="modalUpload">
					<p align="right">
						<h:panelGroup>
							<h:commandButton value="Volver al evento" style="width:160px" action="verEvento" >
								<f:setPropertyActionListener value="#{subirVideoMB.eventId}" target="#{eventoMB.eventId}" />
							</h:commandButton>
						</h:panelGroup>
					</p>
				</a4j:form>
		</rich:modalPanel>
		
		<a4j:form>									
			<rich:panel id="info" rendered="#{subirVideoMB.videoUploaded}">
				<f:facet name="header">
					<h:outputText value="Datos del video" />
				</f:facet>				
		
				<h:outputText value="Descripción:" /><br/>
				<h:inputTextarea value="#{subirVideoMB.description}" cols="85" rows="3"/><br/><br/>
				<h:outputText value="Categorías:" />
				<a4j:repeat value="#{subirVideoMB.categories}" var="category">						 
					<h:selectBooleanCheckbox value="#{category.value}" style="margin-left:20px"/>
					<h:outputText value="#{category.category}"/>
				</a4j:repeat>
				
				<br/><br/>							
				<a4j:commandButton id="newCatButton" value="Nueva Categoria"/>
				<rich:componentControl for="panelNewCat" attachTo="newCatButton" operation="show" event="onclick"/>
				<a4j:commandButton value="Desmarcar categorias" reRender="info" action="#{subirVideoMB.borrarCats}"/>
		
				<br/>
				<p align="right">
					<h:commandButton action="#{subirVideoMB.confirmUpload}" value="Confirmar"
						rendered="#{subirVideoMB.videoUploaded}"/>
					<rich:spacer height="3" />
					<h:commandButton action="#{subirVideoMB.clearUploadData}" value="Cancelar"
						rendered="#{subirVideoMB.videoUploaded}"/>
					<h:commandButton value="Volver al evento" action="verEvento">
						<f:setPropertyActionListener value="#{subirVideoMB.eventId}" target="#{eventoMB.eventId}" />
					</h:commandButton>
				</p>	
			</rich:panel>
		</a4j:form>
		
		<script>window.onload=function(){ 
			if(!#{subirVideoMB.videoUploaded})
				#{rich:component('panel')}.show();
			}
		</script>

	</ui:define>
</ui:composition>
</body>
</html>